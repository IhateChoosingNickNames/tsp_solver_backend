# Tsp solver backend

Description: Application for solving tsp task from csv-file.


Used technologies:
-
    - python 3.11.3
    - fastapi 0.110.0
    - sqlalchemy 2.0.29
    - alembic 1.13.1
    - aio-pika 9.4.1
    - Docker 20.10.22
    - docker compose 3.8
    - poetry


# Launch instructions:

## enviroment:
Create rename env.sample file to .env and fill all keys:

## Docker:
1. To run app simply build it:
    #### docker-compose up -d --build
2. After building apply migrations (or connect your DB):
    #### alembic upgrade head
For now app is available at localhost

## Некоторые комментарии.
1. Данный проект работает по принципу распределенного монолита: web-backend принимает задачи от пользователя, 
создает задачу, возвращает пользователю айди, отправляет сообщение в RMQ. Consumer слушает очередь и 
занимается непосредственной обработкой сообщений. Когда он завершит - зальет данные в БД. Все это время пользователь 
может ставить другие задачи или пытаться получить ответ по текущей - блокировки не будет, т.к. консумер вынесен в отдельный процесс.
А в случае попытки получить данные по незавершенной задаче - получит None.
2. Использование консумера в пределах текущей репы - не самая лучшая идея, но просто не хотелось 2-ую репу создавать.
По факту асинхронка консумеру вообще не нужна - CPU bound задача. По-хорошему тут стоит все вынести в отдельный сервис (сервер)
и там уже запустить пул процессов. Но в целях переиспользования кода - я все разместил в 1 репе.
3. Касательно самой задачи TSP: в задании указано "оптимальный" маршрут. Для этой задачи 
единственное решение для поиска оптимального маршрута имеет факториальную сложность.
Ну и в тестовом файле - 33к точек. 33к! - будет дольше вечности выполняться.
Приближенные алгоритмы (не точный ответ, а приближенный к оптимальности) имеют сложность больше n^2 (пр. n^2 * logn)
Что для 33к ссылок тоже слишком большая сложность.
Поэтому в проекте введены ограничения:
   1) Если число точек до 10 (включительно) - точное решение.
   2) Если до 1000 (включительно) - приближенное решение (квадратичная сложность)
   3) Иначе: ошибка валидации.
4На тесты, увы, времени не хватило.


Author: Larkin Michael